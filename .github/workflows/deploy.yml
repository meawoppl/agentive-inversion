name: Deploy

on:
  push:
    branches: [ main ]

jobs:
  deploy-backend:
    name: Deploy Backend
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    steps:
      - uses: actions/checkout@v4

      - name: Build backend
        run: cargo build --release --package backend

      - name: Deploy placeholder
        run: echo "Backend deployment would happen here"

  deploy-frontend:
    name: Deploy Frontend
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    steps:
      - uses: actions/checkout@v4

      - name: Install Rust
        uses: dtolnay/rust-toolchain@stable
        with:
          targets: wasm32-unknown-unknown

      - name: Install Trunk
        run: cargo install trunk

      - name: Build frontend
        run: cd crates/frontend && trunk build --release

      - name: Deploy placeholder
        run: echo "Frontend deployment would happen here"
